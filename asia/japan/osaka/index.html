<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Osaka — HodoGuides</title>

<!-- Favicon -->
<link rel="icon" type="image/png" href="images/favicon.png" />
<link rel="apple-touch-icon" href="images/favicon.png" />
<meta name="theme-color" content="#0e1420" />

<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet" />
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  :root{ --accent:#8f88ff; }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter;
    color:#fff; background:#0e1420;
    background-image: radial-gradient(ellipse at 50% 40%, #1d2845 0%, #0e1420 60%, #0b0f18 100%);
  }

  /* Header */
  .topbar{
    position:fixed; inset:0 0 auto 0; height:64px; padding:0 12px;
    display:flex; align-items:center; gap:12px; z-index:10;
    background:linear-gradient(180deg, rgba(14,20,32,.95), rgba(14,20,32,.55) 60%, rgba(14,20,32,0));
    backdrop-filter: blur(6px);
  }
  .btn-back{
    display:inline-flex; align-items:center; gap:8px;
    height:40px; padding:0 14px; border-radius:12px;
    background:rgba(255,255,255,.12); color:#fff; text-decoration:none; font-weight:600;
    border:1px solid rgba(255,255,255,.08);
  }
  .title{ font-size:20px; font-weight:800; letter-spacing:.02em; }

  /* Map */
  #map{ position:absolute; inset:0; }

  /* Small clean dot markers */
  .dot{
    width:12px; height:12px; border-radius:50%;
    background:#fff; border:2px solid rgba(0,0,0,.35);
    box-shadow:0 0 6px rgba(0,0,0,.4);
  }

  /* Popup content */
  .pop{
    color:#0e1420; font-family:inherit; min-width: 230px;
  }
  .pop-img{
    width:100%; height:130px; border-radius:10px; overflow:hidden; margin-bottom:10px;
  }
  .pop-img img{ width:100%; height:100%; object-fit:cover; display:block; }
  .pop-title{ font-weight:800; font-size:16px; margin:0 0 6px; }
  .pop-badge{
    display:inline-block; font-size:12px; font-weight:700; letter-spacing:.02em;
    padding:4px 8px; border-radius:999px; background:#eef; color:#333; margin-bottom:8px;
  }
  .pop-note{ font-size:13px; color:#4a5568; margin-bottom:10px; }
  .pop-actions{ display:flex; gap:8px; flex-wrap:wrap; }
  .btn{
    display:inline-flex; align-items:center; gap:6px;
    border-radius:10px; padding:8px 10px; font-size:13px; font-weight:700;
    text-decoration:none; color:#fff; background:var(--accent);
  }
  .btn.secondary{ background:#111; color:#fff; border:1px solid #ddd; }

  /* Mapbox popup theming */
  .mapboxgl-popup-content{ padding:12px; border-radius:12px; }
  .mapboxgl-popup-tip{ border-top-color:#fff !important; }
</style>
</head>
<body>

  <div class="topbar">
    <a class="btn-back" href="./"><i class="fa-solid fa-chevron-left"></i> Back</a>
    <div class="title">Osaka</div>
  </div>

  <div id="map"></div>

<script>
  // Mapbox
  mapboxgl.accessToken = "pk.eyJ1IjoiZXJpa2FyYW1lbGwiLCJhIjoiY21jbmlteXJuMDBjaDJrc2swbnA0a29wZSJ9.F8aX2alF-PpnqInkyqba8g";

  const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/erikaramell/cmcnjverq008y01qw6rir46gy",
    center: [135.5, 34.7],
    zoom: 10.2,
    projection: "globe"
  });
  map.on("style.load", () => map.setFog({}));

  // Lieux d’Osaka
  const pois = [
    {
      id: "usj",
      name: "Universal Studios Japan",
      type: "Theme Park",
      coords: [135.4323, 34.6654],
      img: "https://images.unsplash.com/photo-1578637387939-43c525550085?q=80&w=1200&auto=format&fit=crop",
      note: "Parc à thème populaire avec attractions et spectacles."
    },
    {
      id: "katsuoji",
      name: "Katsuō-ji Temple",
      type: "Temple",
      coords: [135.5129, 34.8854],
      img: "https://images.unsplash.com/photo-1545569341-9eb8b30979d9?q=80&w=1200&auto=format&fit=crop",
      note: "Célèbre pour ses daruma porte-bonheur."
    },
    {
      id: "minoh",
      name: "Minoh Park (Waterfall)",
      type: "Nature",
      coords: [135.4706, 34.8387],
      img: "https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1200&auto=format&fit=crop",
      note: "Randonnée facile jusqu’à une belle cascade."
    },
    {
      id: "harukas",
      name: "Harukas 300 (Abeno Harukas)",
      type: "Observation Deck",
      coords: [135.5132, 34.6459],
      img: "https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?q=80&w=1200&auto=format&fit=crop",
      note: "Vue panoramique sur Osaka depuis le 60ᵉ étage."
    }
  ];

  // Ajout des markers + popups
  const bounds = new mapboxgl.LngLatBounds();
  pois.forEach(p => {
    bounds.extend(p.coords);

    const el = document.createElement("div");
    el.className = "dot";

    const marker = new mapboxgl.Marker(el, { anchor: "center" })
      .setLngLat(p.coords)
      .addTo(map);

    const html = `
      <div class="pop">
        <div class="pop-img"><img src="${p.img}" alt="${p.name}"></div>
        <div class="pop-title">${p.name}</div>
        <div class="pop-badge">${p.type}</div>
        <div class="pop-note">${p.note || ""}</div>
        <div class="pop-actions">
          <a class="btn" target="_blank" rel="noopener"
             href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.name + ' Osaka')}">
            <i class="fa-solid fa-location-arrow"></i> Open in Maps
          </a>
          <a class="btn secondary" href="#${p.id}">
            <i class="fa-solid fa-book-open"></i> More details
          </a>
        </div>
      </div>`;

    const popup = new mapboxgl.Popup({ offset: 16, closeButton: true }).setHTML(html);
    marker.setPopup(popup);
  });

  // Cadre auto + padding top pour le header
  map.on("load", () => {
    map.setPadding({ top: 80, right: 20, bottom: 20, left: 20 });
    map.fitBounds(bounds, { padding: { top: 100, right: 30, bottom: 40, left: 30 }, maxZoom: 14 });
  });
</script>
</body>
</html>