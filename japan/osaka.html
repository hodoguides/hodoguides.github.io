<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Osaka — HodoGuides</title>

<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet" />
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  :root{ --accent:#8f88ff; }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter;
    color:#fff; background:#0e1420;
    background-image:
      radial-gradient(ellipse at 50% 40%, #1d2845 0%, #0e1420 60%, #0b0f18 100%);
  }

  /* Header */
  .topbar{
    position:fixed; inset:0 0 auto 0; height:64px; padding:0 12px;
    display:flex; align-items:center; gap:12px; z-index:10;
    background:linear-gradient(180deg, rgba(14,20,32,.95), rgba(14,20,32,.55) 60%, rgba(14,20,32,0));
    -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
  }
  .btn-back{
    display:inline-flex; align-items:center; gap:8px;
    height:40px; padding:0 14px; border-radius:12px;
    background:rgba(255,255,255,.12); color:#fff; text-decoration:none; font-weight:600;
    border:1px solid rgba(255,255,255,.08);
  }
  .title{
    font-size:20px; font-weight:800; letter-spacing:.02em;
  }

  /* Map */
  #map{ position:absolute; inset:0; }

  /* Custom marker (small dot) */
  .dot{
    width:12px; height:12px; border-radius:50%;
    background:#fff; border:2px solid rgba(0,0,0,.35);
    box-shadow:0 0 6px rgba(0,0,0,.4);
  }

  /* Popup */
  .popup{
    color:#0e1420; font-family:inherit;
    min-width: 180px;
  }
  .popup .h{
    font-weight:800; font-size:16px; margin:0 0 6px;
  }
  .popup .sub{
    font-size:13px; color:#4a5568; margin-bottom:10px;
  }
  .popup .row{
    display:flex; gap:8px;
  }
  .popup .btn{
    display:inline-flex; align-items:center; gap:6px;
    border-radius:10px; padding:8px 10px; font-size:13px; font-weight:600;
    text-decoration:none; color:#fff; background:var(--accent);
  }

  /* Mapbox popup theming */
  .mapboxgl-popup-content{ padding:12px 12px 12px; border-radius:12px; }
  .mapboxgl-popup-tip{ border-top-color:#fff !important; }
</style>
</head>
<body>

  <div class="topbar">
    <a class="btn-back" href="./"><i class="fa-solid fa-chevron-left"></i> Back</a>
    <div class="title">Osaka</div>
  </div>

  <div id="map"></div>

<script>
  // === Mapbox setup ===
  mapboxgl.accessToken = "pk.eyJ1IjoiZXJpa2FyYW1lbGwiLCJhIjoiY21jbmlteXJuMDBjaDJrc2swbnA0a29wZSJ9.F8aX2alF-PpnqInkyqba8g";

  const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/erikaramell/cmcnjverq008y01qw6rir46gy",
    center: [135.5, 34.7], // Osaka area
    zoom: 10.2,
    projection: "globe"
  });

  map.on("style.load", () => map.setFog({}));

  // === POIs ===
  // Coords approximatives précises pour Osaka :
  const pois = [
    {
      id: "usj",
      name: "Universal Studios Japan",
      coords: [135.4323, 34.6654],
      note: "Theme park"
    },
    {
      id: "katsuoji",
      name: "Katsuō-ji Temple",
      coords: [135.5129, 34.8854],
      note: "Daruma temple"
    },
    {
      id: "minoh",
      name: "Minoh Park (Waterfall)",
      coords: [135.4706, 34.8387],
      note: "Nature trail"
    },
    {
      id: "harukas",
      name: "Harukas 300 (Abeno Harukas)",
      coords: [135.5132, 34.6459],
      note: "Observation deck"
    }
  ];

  // Add markers + popups
  const bounds = new mapboxgl.LngLatBounds();
  pois.forEach(p => {
    bounds.extend(p.coords);

    // small dot marker
    const el = document.createElement("div");
    el.className = "dot";

    const marker = new mapboxgl.Marker(el, { anchor: "center" })
      .setLngLat(p.coords)
      .addTo(map);

    // popup html
    const html = `
      <div class="popup">
        <div class="h">${p.name}</div>
        ${p.note ? `<div class="sub">${p.note}</div>` : ""}
        <div class="row">
          <a class="btn" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.name + " Osaka")}" target="_blank" rel="noopener">
            <i class="fa-solid fa-location-arrow"></i> Open in Maps
          </a>
        </div>
      </div>`;

    const popup = new mapboxgl.Popup({ offset: 16, closeButton: true }).setHTML(html);
    marker.setPopup(popup);
  });

  // Fit to all POIs with a bit of top padding (for the header)
  map.on("load", () => {
    map.setPadding({ top: 70, right: 20, bottom: 20, left: 20 });
    map.fitBounds(bounds, { padding: { top: 90, right: 30, bottom: 30, left: 30 }, maxZoom: 14 });
  });

  // Cosmetic: cursor pointer on hover
  map.on("mouseenter", () => map.getCanvas().style.cursor = "default");
</script>
</body>
</html>